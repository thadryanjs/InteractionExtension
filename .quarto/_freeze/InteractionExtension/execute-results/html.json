{
  "hash": "39939569843fcc500fe21d2cbe660c86",
  "result": {
    "markdown": "---\ntitle: \"InteractionExtension\"\n---\n\n::: {.cell}\n\n```{.r .cell-code}\n# reproducible R environments\nlibrary(groundhog)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoaded 'groundhog' (version:2.2.0) using R-4.2.2\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nTips and troubleshooting: https://groundhogR.com\n```\n:::\n\n```{.r .cell-code}\n# dependencies\npkgs <- c(\n  \"dplyr\",\n  \"ggplot2\",\n  \"ggcorrplot\",\n  \"mvtnorm\"\n)\n\n# activate libraries\nsuppressMessages(groundhog.library(pkgs, \"2023-03-01\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(11)\n\nx <- runif(100)\n\nx %>% head\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.2772497942 0.0005183129 0.5106083730 0.0140479084 0.0646897766\n[6] 0.9548492255\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# compute distance matrix, d_{ij} = |x_i - x_j|\nd <- abs(outer(x, x, \"-\")) \n\nd %>% dim\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 100 100\n```\n:::\n\n```{.r .cell-code}\nd[, 1:5] %>% head\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          [,1]       [,2]      [,3]       [,4]       [,5]\n[1,] 0.0000000 0.27673148 0.2333586 0.26320189 0.21256002\n[2,] 0.2767315 0.00000000 0.5100901 0.01352960 0.06417146\n[3,] 0.2333586 0.51009006 0.0000000 0.49656046 0.44591860\n[4,] 0.2632019 0.01352960 0.4965605 0.00000000 0.05064187\n[5,] 0.2125600 0.06417146 0.4459186 0.05064187 0.00000000\n[6,] 0.6775994 0.95433091 0.4442409 0.94080132 0.89015945\n```\n:::\n\n```{.r .cell-code}\nd %>% ggcorrplot()\n```\n\n::: {.cell-output-display}\n![](InteractionExtension_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# length scale\nl <- 1\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# squared exponential kernel\nSigma_SE <- exp(-d^2/(2*l^2)) \n\nSigma_SE %>% dim\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 100 100\n```\n:::\n\n```{.r .cell-code}\nSigma_SE[, 1:5] %>% head\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          [,1]      [,2]      [,3]      [,4]      [,5]\n[1,] 1.0000000 0.9624336 0.9731392 0.9659554 0.9776624\n[2,] 0.9624336 1.0000000 0.8780112 0.9999085 0.9979431\n[3,] 0.9731392 0.8780112 1.0000000 0.8840107 0.9053608\n[4,] 0.9659554 0.9999085 0.8840107 1.0000000 0.9987185\n[5,] 0.9776624 0.9979431 0.9053608 0.9987185 1.0000000\n[6,] 0.7948749 0.6342109 0.9060372 0.6423939 0.6728775\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nSigma_SE %>% \n  ggcorrplot()\n```\n\n::: {.cell-output-display}\n![](InteractionExtension_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ny <- rmvnorm(1, sigma = Sigma_SE)\n\ny %>% dim\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1]   1 100\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(x,y)\n```\n\n::: {.cell-output-display}\n![](InteractionExtension_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndecayVariable <- function(n, scale_factor = 1)\n{\n\n  # adopted from:\n  # https://stephens999.github.io/fiveMinuteStats/gaussian_process.html\n  x <- runif(n)\n  # compute distance matrix, d_{ij} = |x_i - x_j|\n  distances <- abs(outer(x, x, \"-\")) \n  # squared exponential kernel\n  Sigma_SE = exp(-distances^2/(2*scale_factor^2)) \n  list(x = x, y = rmvnorm(1, sigma = Sigma_SE))\n}\n\nvar <- decayVariable(100)\nplot(var$x, var$y)\n```\n\n::: {.cell-output-display}\n![](InteractionExtension_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- data.frame(\n  response = runif(100),\n  var1 = rnorm(100, 5, 1),\n  var2 = rnorm(100, 2, 1),\n  var_spacial = var$y[,] \n)\n\ndf %>% head\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    response     var1      var2 var_spacial\n1 0.06056465 5.177035 0.6328325  -1.2404606\n2 0.66540477 4.778658 3.7702046  -0.7326211\n3 0.23416590 5.901520 0.8736924  -0.1499718\n4 0.04955610 4.950686 3.7785802  -0.4837612\n5 0.21251019 4.562043 3.3382266  -0.2640132\n6 0.15141651 5.471702 1.9969366  -0.7427530\n```\n:::\n:::\n\n::: {.cell}\n\n:::\n",
    "supporting": [
      "InteractionExtension_files/figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}